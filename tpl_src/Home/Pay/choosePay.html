<!DOCTYPE html>  
<html lang="zh-cn">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">  
    <title>选择支付方式</title>  
    <link rel="stylesheet" href="__PUBLIC_BOOTSTRAP__/css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="__PUBLIC_CSS__/common.css" />-->
    <style type="text/css">
    	html{background-color: #F0F0F0;}
    	#body{background-color: #F0F0F0;}
    	.main{width:100%;min-height:150px;margin:50px auto;background-color: #fff;}	
    	.commonHead{width:100%;position: fixed;top: 0;left: 0;z-index: 20;}
    	
    	.paymentInfo{width: 100%;display: block;}
    	.addCart{width: 100%;height: 50px;border-top: 1px solid #DEDEDE;position: fixed;bottom: 0;left: 0;z-index: 2;background:#2490ed;color:#fff;
    	line-height: 50px;font-size: 16px;}
    	.payCheck{width: 100%;height: 35%;background: #fff;color: #000;text-align: center;}
    	.payCheck>span{width: 100%;height: 25%;display: block;line-height: 50px;font-size: 16px;font-weight: bold;}
    	.radioBox{width: 90%;min-height: 30px; margin-left: 5%;font-size: 14px;display: block;}
    	.form-group{width: 100%;height:30px;display: block;}
    	.form-group>label{font-weight: normal;display: inline-block;width: 35%;float: left;text-align: left;}
    	.form-group>input[type=checkbox], input[type=radio]{width: 16px;height: 16px;display: inline-block;width: 60%;float: right;}
    	.payCheck>p{width: 90%;height: 15%;font-size: 14px;color: #FF6600;display: block;margin-left: 5%;}
    	.topay{width: 100%;height: 50px;border-top: 1px solid #DEDEDE;position: fixed;bottom: 0;left: 0;z-index: 2;background:#2490ed;color:#fff;
    	line-height: 50px;font-size: 16px;}
    	.ir_unpaid{width:30%;height: 30px;line-height: 30px;display: block;float: left;}
    	.priceunit {width: 30%; height: 30px;line-height: 30px;display: block;float: left;text-align: left;}
    	
    	
    	
    	@media screen and (min-width:1200px) {
			.main{width: 1200px;}
			.addCart{width: 1200px;margin-left: -600px;left: 50%;}
		}
    </style>
</head>  
<body id="body">  
    <div class="commonHead">
  		<include file="Common/commonHead1" />
  	</div>
    <div class="main">  
		<form class="paymentInfo" id="paymentInfo" action="{:U('Home/Pay/receiptSon')}" method="post" >
			<input type="hidden" name="ir_receiptnum" id="ir_receiptnum" value="{:I('get.ir_receiptnum')}" />
			<div class="payCheck">
				<span class="tc">选择类型</span>
				<div class="radioBox">
					<div class="form-group" onclick="changeRadio(this);">
						<label for="">IPS支付:</label>
					    <input class="fr" type="radio" name="ip_paytype"  value="1" checked="checked" />
					</div>
					<div class="form-group" onclick="changeRadio(this);">
						<label for="">积分支付:</label>
					    <input class="fr" type="radio" name="ip_paytype"  value="2"  />
					</div>
					<div class="form-group">
						<label for="">本次付款金额:</label>
						
					    <input type="text" class="ir_unpaid" name="ir_unpaid" id="ir_unpaid" value="{:I('get.ir_unpaid')}"/>
					    
					    <input type="text" class="ir_unpaid" name="ir_unpaid" id="ir_unpaid" value="{:I('get.ir_unpaid')}"/>
					    
					    <span class="priceunit" id="priceunit">RMB</span>
					</div>
				</div>
				<p class="tc">合计:&nbsp;&nbsp;￥<i id="money">{:I('get.ir_price')}</i>&nbsp;&nbsp;EP&nbsp;<span id="point">{:I('get.ir_point')}</span></p>				
				<p class="tc">待付款:&nbsp;&nbsp;￥<i id="unmoney">{:I('get.ir_unpaid')}</i>&nbsp;&nbsp;EP&nbsp;<span id="unpoint">{:I('get.ir_unpoint')}</span></p>
			</div>
			<div class="addCart tc" onclick="topay()">去付款</div>
		</form>
    </div>  
    
	<script src="__PUBLIC_BOOTSTRAP__/js/jquery-1.11.0.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="__PUBLIC_BOOTSTRAP__/js/bootstrap.min.js"></script>  
	<script type="text/javascript">
		$(document).ready(function(){
	   		changeCommonHead('选择支付方式');
	   		$("input[name='ir_unpaidep']").val($("input[name='ir_unpaid']").val()/100);
		});
		function back(){
        	window.location.href ="{:U('Home/Purchase/center')}";
   		}
	//改变支付类型单选框
		function changeRadio(val){
			var inputs=$(val).find("input");
			inputs[0].checked='checked';
			var typevalue=$(":radio[name='ip_paytype']:checked").val();
			if($('#priceunit').text()=='RMB'){
				if(typevalue==2){
					$('#priceunit').text('EP');
					$("#ir_unpaid").val($("#ir_unpaid").val()/100.0);
				}
			}else{
				if(typevalue==1){
					$('#priceunit').text('RMB');
					$("#ir_unpaid").val(($("#ir_unpaid").val()*100).toFixed(2));
				}
				
			}
		}
		function topay(){
			var form=$('#paymentInfo');
			var ir_unpaid=$("input[name='ir_unpaid']").val();
			var typevalue=$(":radio[name='ip_paytype']:checked").val();
			var money=$('#unmoney').text();
			if(typevalue==2){
				if(ir_unpaid>=(money/1000.0)){
					form.submit();
				}else{
					alert('付款金额须大于未付款的10%')
				}
			}else{
				if(ir_unpaid>=(money/10.0)){
					form.submit();
				}else{
					alert('付款金额须大于未付款的10%')
				}
			}
		}

	</script>  
</body>  
</html>  