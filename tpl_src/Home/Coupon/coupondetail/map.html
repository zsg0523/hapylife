<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <title></title>
    <style>
        html,body{height:100%;margin:0;padding:0;}
        #mapBox{min-height:100%;margin: 0 auto;}
        /*大屏幕*/
		@media screen and (min-width:1200px){
		   #mapBox{width: 1200px;}
		}	   
    </style>
<body>	
<div class="commonHead">
	<include file="Coupon/common/commonHead"/>
</div>	
<div id='mapBox'></div> 
<input id="cmap" type="hidden" value="{$location}"></input>
</body>
<script type="text/javascript" src="__PUBLIC_JS__/jquery-1.10.2.js" ></script>
<script type="text/javascript" src="__PUBLIC_JS__/map.js"></script>
<script type="text/javascript" src="__PUBLIC_JS__/api.js" ></script>
<script type="text/javascript">
	$(function(){ 
	    changeCommonHead('具体位置');	
	});
    
	//创建地图
	var map = new AMap.Map("mapBox", {
	    resizeEnable: true,
	    center: [116.397428,39.90923],
	    zoom:14
	});
	
	//添加标注
	function addMarker(point) {
	    var marker = new AMap.Marker({
	        map: map,
	        position: [point.getLng(),point.getLat()]
	    });
	}
	
	//地图中心点添加标注
	function addCenterPoint(){
	    map.clearMap();
	    var centerPoint = map.getCenter();
	    addMarker(centerPoint);
	}	
	addCenterPoint();
	
	function geocoder() {
		//得到入场券的入场地址
		  var addr = $("#cmap").val();
	    map.clearMap();
	    var myGeo = new AMap.Geocoder();
	    //地理编码,返回地理编码结果
	    myGeo.getLocation(addr, function(status, result) {
	        if (status === 'complete' && result.info === 'OK') {
	            //地址解析成功
	            geocoder_CallBack(result);
	        }	
	        else{
	            
	        }
	    });
	}
    geocoder();	
	
	//地理编码返回结果展示
	function geocoder_CallBack(data) {
	    var geocode = data.geocodes;
	    addMarker(geocode[0].location);
	    map.setFitView();
	}
	
	map.on('moveend', function() {
	    addCenterPoint();
	});
</script>
</html>